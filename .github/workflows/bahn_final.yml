name: Bahn Monitor Loop
on:
  workflow_dispatch:
  schedule:
    - cron: '*/40 * * * *'
jobs:
  run:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
      - name: Run Bot
        run: |
          pip install requests
          # Das Skript ausführen und prüfen, ob es Dateien erzeugt
          python fetch_all_stations.py
          
          git config --global user.name "Bot"
          git config --global user.email "bot@example.com"
          
          # Sicherstellen, dass alle JSONs erfasst werden
          git add *.json
          
          # Nur committen und pushen, wenn sich der Inhalt wirklich geändert hat
          if ! git diff --cached --quiet; then
            git commit -m "Live Update $(date +%H:%M)"
            git push origin main
          else
            echo "Keine Änderungen vom Skript erzeugt."
          fi
