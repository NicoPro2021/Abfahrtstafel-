<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abfahrtstafel Zerbst/Anhalt</title>
    <style>
        body { background-color: black; color: white; font-family: Arial, sans-serif; margin: 0; padding: 0; }
        .header { background-color: #0099ff; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { margin: 0; font-size: 24px; }
        .uhrzeit { color: #ffcc00; font-size: 24px; font-weight: bold; }
        
        .tafel { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .zug-zeile { border-bottom: 1px solid #333; height: 60px; }
        .ausfall { background-color: white !important; color: black !important; }
        
        .zeit { color: #ffcc00; font-size: 22px; padding-left: 10px; width: 80px; }
        .linie { background-color: white; color: #003399; padding: 2px 5px; font-weight: bold; border-radius: 3px; margin-right: 10px; }
        .ausfall .linie { background-color: #003399; color: white; }
        
        .ziel { font-size: 22px; font-weight: bold; }
        .gleis { color: #ffcc00; font-size: 22px; text-align: right; padding-right: 15px; }
        .ausfall .zeit, .ausfall .gleis { color: black; }
        
        .info-scroll { color: red; font-size: 16px; white-space: nowrap; overflow: hidden; width: 200px; }
        .scroll-text { display: inline-block; padding-left: 100%; animation: scroll 10s linear infinite; }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
    </style>
</head>
<body>

<div class="header">
    <h1>Zerbst/Anhalt</h1>
    <div id="uhr" class="uhrzeit">00:00:00</div>
</div>

<table class="tafel" id="abfahrten">
    </table>

<script>
    // Uhrzeit-Funktion
    function updateUhr() {
        const jetzt = new Date();
        document.getElementById('uhr').innerText = jetzt.toLocaleTimeString('de-DE');
    }
    setInterval(updateUhr, 1000);

    // Daten von daten.json laden
    async function ladeDaten() {
        try {
            // Wir hängen einen Zeitstempel an, um Cache-Probleme zu vermeiden
            const response = await fetch('daten.json?t=' + Date.now());
            const daten = await response.json();
            const tafel = document.getElementById('abfahrten');
            tafel.innerHTML = '';

            daten.forEach(zug => {
                const istAusfall = zug.info.includes("Ausfall") || zug.info.includes("fällt aus");
                const zeile = document.createElement('tr');
                zeile.className = 'zug-zeile' + (istAusfall ? ' ausfall' : '');

                zeile.innerHTML = `
                    <td class="zeit">${zug.zeit}</td>
                    <td class="ziel">
                        <span class="linie">${zug.linie}</span> ${zug.ziel}
                        ${zug.info ? `<div class="info-scroll"><span class="scroll-text">${zug.info}</span></div>` : ''}
                    </td>
                    <td class="gleis">${istAusfall ? '--' : zug.gleis}</td>
                `;
                tafel.appendChild(zeile);
            });
        } catch (e) {
            console.error("Fehler beim Laden der daten.json:", e);
        }
    }

    // Alle 30 Sekunden aktualisieren
    ladeDaten();
    setInterval(ladeDaten, 30000);
</script>

</body>
</html>
